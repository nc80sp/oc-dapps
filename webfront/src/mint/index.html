<!doctype html>
<html lang="ja">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>ã‚ªãƒ¼ãƒ—ãƒ³ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‚åŠ è¨¼ NFTç™ºè¡Œ</title>
	<style>
		body {
			font-family: system-ui, -apple-system, Segoe UI, Roboto, "ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ ProN W3", "Hiragino Kaku Gothic ProN", Meiryo, Arial;
			margin: 24px;
			background: #0b0b12;
			color: #e6eefc
		}

		h1 {
			font-size: 20px;
			margin-bottom: 8px
		}

		.left {
			width: 420px
		}

		canvas {
			background: #05050a;
			border-radius: 12px;
			box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
			display: block
		}

		.controls {
			margin-top: 12px;
			display: grid;
			gap: 8px
		}

		input[type=text],
		input[type=file],
		button,
		select {
			padding: 8px;
			border-radius: 8px;
			border: 1px solid rgba(255, 255, 255, 0.08);
			background: rgba(255, 255, 255, 0.02);
			color: inherit
		}

		button {
			cursor: pointer
		}

		.small {
			font-size: 13px;
			color: #9fb0ff
		}

		.note {
			font-size: 13px;
			color: #a8b6db;
			margin-top: 6px
		}

		label {
			font-size: 13px;
			color: #9fb0ff
		}

		.right {
			flex: 1;
			min-width: 300px
		}

		textarea {
			width: 100%;
			height: 160px;
			padding: 8px;
			border-radius: 8px;
			background: rgba(255, 255, 255, 0.02);
			border: 1px solid rgba(255, 255, 255, 0.04);
			color: inherit
		}

		.row {
			display: flex;
			gap: 8px
		}


		.container {
			display: flex;
			justify-content: center;
			/* æ¨ªæ–¹å‘ä¸­å¤® */
			flex-direction: column;
			align-items: center;
		}

		.address-container {
			display: flex;
			align-items: center;
			background: #f0f0f0;
			padding: 1rem;
			border-radius: 10px;
			margin-bottom: 1rem;
			width: 100%;
			max-width: 400px;
			word-break: break-all;
			justify-content: space-between;
			text-align: center;
		}

		.address-text {
			font-size: 1rem;
			color: #333;
		}

		.copy-btn {
			background: #4CAF50;
			color: white;
			border: none;
			border-radius: 5px;
			padding: 0.5rem 1rem;
			font-size: 0.9rem;
			cursor: pointer;
			white-space: nowrap;
		}

		.copy-btn:active {
			background: #45a049;
		}

		.message {
			font-size: 0.9rem;
			color: #4CAF50;
			min-height: 1.2rem;
		}
	</style>
</head>

<body>
	<h1 style="text-align: center;">ã‚ªãƒ¼ãƒ—ãƒ³ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‚åŠ è¨¼ NFTç™ºè¡Œãƒšãƒ¼ã‚¸</h1>
	<div style="margin-top:20px; text-align: center;">
		<button id="mint" style="margin-top:20px; font-size:20px; padding:10px 30px;">ğŸ‰ å‚åŠ è¨¼NFT ã‚’ç™ºè¡Œã™ã‚‹</button>
		<p id="msg" style="text-align: center;"></p>
	</div>
	<div class="container" id="container">
		<div class="address-container">
			<span style="color:black;white-space: nowrap;"><b>[ã‚¢ãƒ‰ãƒ¬ã‚¹]</b></span>
			<span class="address-text" id="contractAddress"></span>
			<button class="copy-btn" id="copyBtn">ã‚³ãƒ”ãƒ¼</button>
		</div>
		<div class="message" id="copyMessage"></div>
		<br>
		<div class="address-container">
			<span style="color:black;white-space: nowrap;"><B>[ID]</B></span>
			<span class="address-text" id="tokenID"></span>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
	<script src="../ocpass.js"></script>
	<script>
		const copyBtn = document.getElementById('copyBtn');
		const addressText = document.getElementById('contractAddress');
		const copyMessage = document.getElementById('copyMessage');
		const container = document.getElementById('container');
		addressText.innerHTML = GetContractAddress();
		container.style.display = "none";

		copyBtn.addEventListener('click', async () => {
			try {
				await navigator.clipboard.writeText(addressText.textContent);
				copyMessage.textContent = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
				setTimeout(() => copyMessage.textContent = '', 2000);
			} catch (err) {
				copyMessage.textContent = 'ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ';
			}
		});

		document.getElementById('mint').addEventListener('click', clickMint);

		async function clickMint() {
			document.getElementById('mint').style.display = "none";
			document.getElementById('msg').innerHTML = "æ¥ç¶šä¸­...";
			let result = await connectWallet(false);
			if (!result) {
				document.getElementById('msg').innerHTML = "æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ";
				return;
			}
			let tokenID = await hasNFT(NFT_TYPE.PARTICIPATION);
			if (tokenID > 0) {
				container.style.display = "";
				document.getElementById('msg').innerHTML = "å‚åŠ è¨¼NFTã¯ã™ã§ã«ç™ºè¡Œæ¸ˆã¿ã§ã™";
				document.getElementById('tokenID').innerHTML = tokenID;
			} else {
				tokenID = await mintNFT(NFT_TYPE.PARTICIPATION);
				if (tokenID == 0) {
					document.getElementById('msg').innerHTML = "å‚åŠ è¨¼NFT ã®ç™ºè¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
				} else {
					container.style.display = "";
					document.getElementById('msg').innerHTML = "å‚åŠ è¨¼NFT ã‚’ç™ºè¡Œã—ã¾ã—ãŸï¼";
					document.getElementById('tokenID').innerHTML = tokenID;
				}
			}
		}
	</script>
</body>

</html>